
# DEVONthink Search

Powerful tool for seaching in DEVONthink. [中文说明](https://github.com/mpco/AlfredWorkflow-DEVONthink-Search/blob/master/README_CN.md)

There are two editions:

- **DEVONthink Search**, for DEVONthink Personal
    - [Download](https://github.com/mpco/AlfredWorkflow-DEVONthink-Search/releases/download/3.0/DEVONthink.Search.alfredworkflow)
    - Search results aren't perfect, as the workflow searches with `Spotlight Index` generated by DEVONthink.
    - It's necessary to enable `Create Spotlight Index` in Database Property. (Enabled by default)
    - It **only** support the following `dnt` keyword and single database.
- **DEVONthink Pro Search**, for DEVONthink Pro/Pro Office
    - [Download](https://github.com/mpco/AlfredWorkflow-DEVONthink-Search/releases)
    - Search results are the same as in DEVONthink, sorted by keywords matching score. (Groups in the results are filtered out.)
    - It's not necessary to enable `Create Spotlight Index`.
    - The information displayed in the search results is more abundant.

![Comparison](https://user-images.githubusercontent.com/3690653/48790858-3f872c00-ed2b-11e8-8ae6-683ce19cc597.png)

- The subtext of result in `DEVONthink Search` is the download url or the path of Spotlight Index.
- The subtext of result in `DEVONthink Pro Search` consists of the database name and group name which contained the file. It will show tags when you press `⌘Command`.


## Usage

- Type `dnt + keywords` to search in all opened databases. 
- Type `dnd` to choose which datebase to search
    - Press `Enter`, then type in `keywords` to search in the chosen database. 
    - Press `⌘Command + Enter` to list all tags in the database, then choose a tag and press `Enter` to list all documents which have the tag.
- Type `dnm + tag1, tag2, ...` to list all documents which have these tags in all database. **Tags inputed must be exact. For example, Tag `aBcD` can't be inputed as `aBc` or `abcd`**

After documents were listed,

- Press `Enter` to open the selected result with DEVONthink.
- Press `⌘Command + Enter` to open with external editor. 
- Press `⌥Option + Enter` to reveal result in DEVONthink.

![Enter](https://user-images.githubusercontent.com/3690653/48790940-73625180-ed2b-11e8-89dc-6bf4f6b9e72a.png)

## Configuration

**ONLY for DEVONthink Pro Search**

`dnt` and `dnm` search in **all** opened databases  in `DEVONthink Pro Search`. You can ignore some databases by setting `ignoredDbUuidList` environment variable in Alfred workflow.

1. Copy database link in DEVONthink, which is similar to `x-devonthink-item://1FC1A542-D8CA-4807-B806-8617966870B5`.
2. The part `1FC1A542-D8CA-4807-B806-8617966870B5` is the database's UUID.
3. Fill in workflow configuration with UUIDs. You should separate multiple UUIDs with comma(,).

![Configuration](https://user-images.githubusercontent.com/3690653/48790986-9987f180-ed2b-11e8-8f64-846d96fd26b9.png)

## Known issues

CJK (Chinese, Japanese, and Korean) characters should be added `~` in the front when seaching in DEVONthink. For example, searching keywords `你abc我他` should be converted to `~你abc~我他`. It's added automatically in `DEVONthink Pro Search` by using regular expression `/(\p{Unified_Ideograph}+)/ug` to matching Chinese characters.

The regular expression `/(\p{Unified_Ideograph}+)/ug` can't match Japanese or Korean characters. You can research more perfect regular expressions which match CJK and tell me.
